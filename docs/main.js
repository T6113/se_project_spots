!function(){"use strict";const e=(e,t,r)=>{const n=t.id+"-error";e.querySelector("#"+n).textContent="",t.classList.remove(r.inputErrorClass)},t=(e,t,o)=>{(e=>e.some((e=>!e.validity.valid)))(e)?r(t,o):n(t,o)},r=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.disabled=!0},n=(e,t)=>{e.classList.remove(t.inactiveButtonClass),e.disabled=!1},o=(t,r,n)=>{r.forEach((r=>{e(t,r,n)}))},a={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"};function s(e,t,r=e.textContent,n=`${r.slice(0,-1)}ing...`){t?(e.dataset.originalText=e.textContent,e.textContent=n):e.textContent=e.dataset.originalText||r}const c=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this.checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this.checkResponse)}PostCards(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this.checkResponse)}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this.checkResponse)}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this.checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this.checkResponse)}handleLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this.checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"0cbcd021-9e1a-4910-8e9a-26f9b65490b3","Content-Type":"application/json"}});c.getAppInfo().then((([e,t])=>{console.log(e),e.forEach((function(e){const t=H(e);J.append(t)})),$.src=t.avatar,E.textContent=t.name,k.textContent=t.about})).catch(console.error);const i=document.querySelector(".profile__edit-btn"),l=document.querySelector("#edit-profile-modal"),d=document.querySelector(".profile__avatar-btn"),u=l.querySelector(".modal__close-btn"),m=l.querySelector(".modal__form"),_=l.querySelector("#profile-name-input"),h=l.querySelector("#profile-description-input"),f=document.querySelector(".profile__add-btn"),y=document.querySelector("#new-post-modal"),p=y.querySelector(".modal__close-btn"),v=y.querySelector(".modal__submit-btn"),b=y.querySelector(".modal__form"),S=y.querySelector(" #card-image-input"),q=y.querySelector(" #card-caption-input"),E=document.querySelector(".profile__title"),k=document.querySelector(".profile__description"),L=document.querySelector("#avatar-modal"),C=L.querySelector(".modal__close-btn"),g=L.querySelector(".modal__submit-btn"),x=L.querySelector(".modal__form"),U=L.querySelector("#profile-avatar-input"),$=document.querySelector(".profile__avatar"),A=document.querySelector("#delete-modal"),I=A.querySelector(".modal__form"),T=document.querySelector(".modal__submit-btn_cancel"),D=A.querySelector(".modal__close-btn_confirmation_delete"),P=document.querySelector("#preview-modal"),R=P.querySelector(".modal__close-btn"),w=P.querySelector(".modal__image"),B=P.querySelector(".modal__caption");let N,O;const j=document.querySelector("#card-template").content.querySelector(".card"),J=document.querySelector(".cards__list");function H(e){const t=j.cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-btn");let a=e.isLiked;return a&&o.classList.add("card__like-btn_active"),n.src=e.link,n.alt=e.name,r.textContent=e.name,o.addEventListener("click",(()=>{c.handleLikeStatus(e._id,a).then((e=>{a=!a,a?o.classList.add("card__like-btn_active"):o.classList.remove("card__like-btn_active")})).catch(console.error)})),t.querySelector(".card__delete-btn").addEventListener("click",(r=>function(e,t){N=e,O=t,z(A)}(t,e._id))),n.addEventListener("click",(()=>{w.src=e.link,w.alt=e.name,B.textContent=e.name,z(P)})),t}function z(e){e.classList.add("modal_is-opened"),document.addEventListener("keydown",G)}function M(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keydown",G)}i.addEventListener("click",(function(){_.value=E.textContent,h.value=k.textContent,o(m,[_,h],a),z(l)})),u.addEventListener("click",(function(){M(l)})),f.addEventListener("click",(function(){z(y)})),p.addEventListener("click",(function(){M(y)})),R.addEventListener("click",(function(){M(P)})),m.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;s(t,!0),c.editUserInfo({name:_.value,about:h.value}).then((e=>{E.textContent=e.name,k.textContent=e.about,M(l)})).catch(console.error).finally((()=>{s(t,!1)}))})),b.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;s(t,!0),c.PostCards(q.value,S.value).then((e=>{const t=H(e);J.prepend(t),b.reset(),r(v,a),M(y)})).catch(console.error).finally((()=>{s(t,!1)}))}));const F=document.querySelectorAll(".modal");function G(e){"Escape"===e.key&&M(document.querySelector(".modal_is-opened"))}d.addEventListener("click",(()=>{o(x,[U],a),z(L)})),C.addEventListener("click",(()=>{M(L)})),x.addEventListener("submit",(e=>{!function(e,t){t.preventDefault();const n=t.submitter;s(n,!0),c.editAvatarInfo(U.value).then((t=>{console.log(t),e.src=t.avatar,x.reset(),r(g,a),M(L)})).catch(console.error).finally((()=>{s(n,!1)}))}($,e)})),I.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;s(t,!0,"Delete"),c.deleteCard(O).then((()=>{N.remove(),M(A)})).catch(console.error).finally((()=>{s(t,!1,"Delete")}))})),T.addEventListener("click",(()=>{M(A)})),D.addEventListener("click",(()=>{M(A)})),F.forEach((e=>{e.addEventListener("mousedown",(t=>{t.target.classList.contains("modal")&&M(e)}))})),(r=>{document.querySelectorAll(r.formSelector).forEach((n=>{((r,n)=>{const o=Array.from(r.querySelectorAll(n.inputSelector)),a=r.querySelector(n.submitButtonSelector);t(o,a,n),o.forEach((s=>{s.addEventListener("input",(function(){((t,r,n)=>{r.validity.valid?e(t,r,n):((e,t,r,n)=>{const o=t.id+"-error";e.querySelector("#"+o).textContent=r,t.classList.add(n.inputErrorClass)})(t,r,r.validationMessage,n)})(r,s,n),t(o,a,n)}))}))})(n,r)}))})(a)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQUEsTUFPTUEsRUFBaUJBLENBQUNDLEVBQVFDLEVBQVNDLEtBQ3ZDLE1BQU1DLEVBQWlCRixFQUFRRyxHQUFLLFNBQ2JKLEVBQU9LLGNBQWMsSUFBTUYsR0FDbkNHLFlBQWMsR0FDN0JMLEVBQVFNLFVBQVVDLE9BQU9OLEVBQVNPLGtCQWlCOUJDLEVBQW9CQSxDQUFDQyxFQUFXQyxFQUFVVixLQU52QlMsSUFDaEJBLEVBQVVFLE1BQU1DLElBQ2JBLEVBQWFDLFNBQVNDLFFBSzVCQyxDQUFnQk4sR0FDbEJPLEVBQXFCTixFQUFVVixHQUUvQmlCLEVBQWFQLEVBQVVWLElBSWRnQixFQUF1QkEsQ0FBQ04sRUFBVVYsS0FDN0NVLEVBQVNMLFVBQVVhLElBQUlsQixFQUFTbUIscUJBQ2hDVCxFQUFTVSxVQUFXLEdBR2hCSCxFQUFlQSxDQUFDUCxFQUFVVixLQUM5QlUsRUFBU0wsVUFBVUMsT0FBT04sRUFBU21CLHFCQUNuQ1QsRUFBU1UsVUFBVyxHQUdUQyxFQUFrQkEsQ0FBQ3ZCLEVBQVFXLEVBQVdULEtBQ2pEUyxFQUFVYSxTQUFTQyxJQUNqQjFCLEVBQWVDLEVBQVF5QixFQUFPdkIsT0NoRHJCQSxFQUFXLENBQ3RCd0IsYUFBYyxlQUNkQyxjQUFlLGdCQUNmQyxxQkFBc0IscUJBQ3RCUCxvQkFBcUIsNkJBQ3JCWixnQkFBaUIsMEJBQ2pCb0IsV0FBWSxnQkNOUCxTQUFTQyxFQUNkQyxFQUNBQyxFQUNBQyxFQUFhRixFQUFPekIsWUFDcEI0QixFQUFjLEdBQUdELEVBQVdFLE1BQU0sR0FBSSxZQUVsQ0gsR0FDRkQsRUFBT0ssUUFBUUMsYUFBZU4sRUFBT3pCLFlBQ3JDeUIsRUFBT3pCLFlBQWM0QixHQUVyQkgsRUFBT3pCLFlBQWN5QixFQUFPSyxRQUFRQyxjQUFnQkosQ0FFeEQsQ0NGQSxNQWdDTUssRUFBTSxJQzFDWixNQUNFQyxXQUFBQSxFQUFZLFFBQUVDLEVBQU8sUUFBRUMsSUFDckJDLEtBQUtDLFNBQVdILEVBQ2hCRSxLQUFLRSxTQUFXSCxDQUNsQixDQUVBSSxhQUFBQSxDQUFjQyxHQUNaLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQU8sVUFBVUosRUFBSUssU0FDdEMsQ0FFQUMsVUFBQUEsR0FDRSxPQUFPSCxRQUFRSSxJQUFJLENBQUNYLEtBQUtZLGtCQUFtQlosS0FBS2EsZUFDbkQsQ0FFQUEsV0FBQUEsR0FDRSxPQUFPQyxNQUFNLEdBQUdkLEtBQUtDLG9CQUFxQixDQUN4Q0YsUUFBU0MsS0FBS0UsV0FDYmEsS0FBS2YsS0FBS0csY0FDZixDQUVBUyxlQUFBQSxHQUNFLE9BQU9FLE1BQU0sR0FBR2QsS0FBS0MsaUJBQWtCLENBQ3JDRixRQUFTQyxLQUFLRSxXQUNiYSxLQUFLZixLQUFLRyxjQUNmLENBRUFhLFNBQUFBLENBQVVDLEVBQU1DLEdBQ2QsT0FBT0osTUFBTSxHQUFHZCxLQUFLQyxpQkFBa0IsQ0FDckNrQixPQUFRLE9BQ1JwQixRQUFTQyxLQUFLRSxTQUNka0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkwsT0FDQUMsV0FFREgsS0FBS2YsS0FBS0csY0FDZixDQUVBb0IsWUFBQUEsRUFBYSxLQUFFTixFQUFJLE1BQUVPLElBQ25CLE9BQU9WLE1BQU0sR0FBR2QsS0FBS0Msb0JBQXFCLENBQ3hDa0IsT0FBUSxRQUNScEIsUUFBU0MsS0FBS0UsU0FDZGtCLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJMLE9BQ0FPLFlBRURULEtBQUtmLEtBQUtHLGNBQ2YsQ0FFQXNCLGNBQUFBLENBQWVDLEdBQ2IsT0FBT1osTUFBTSxHQUFHZCxLQUFLQywyQkFBNEIsQ0FDL0NrQixPQUFRLFFBQ1JwQixRQUFTQyxLQUFLRSxTQUNka0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkksYUFFRFgsS0FBS2YsS0FBS0csY0FDZixDQUVBd0IsVUFBQUEsQ0FBV2pFLEdBQ1QsT0FBT29ELE1BQU0sR0FBR2QsS0FBS0Msa0JBQWtCdkMsSUFBTSxDQUMzQ3lELE9BQVEsU0FDUnBCLFFBQVNDLEtBQUtFLFdBQ2JhLEtBQUtmLEtBQUtHLGNBQ2YsQ0FFQXlCLGdCQUFBQSxDQUFpQmxFLEVBQUltRSxHQUNuQixPQUFPZixNQUFNLEdBQUdkLEtBQUtDLGtCQUFrQnZDLFVBQVksQ0FDakR5RCxPQUFRVSxFQUFVLFNBQVcsTUFDN0I5QixRQUFTQyxLQUFLRSxXQUNiYSxLQUFLZixLQUFLRyxjQUNmLEdEL0JrQixDQUNsQkwsUUFBUyxrREFDVEMsUUFBUyxDQUNQK0IsY0FBZSx1Q0FDZixlQUFnQixzQkFJcEJsQyxFQUNHYyxhQUNBSyxNQUFLLEVBQUVnQixFQUFPQyxNQUNiQyxRQUFRQyxJQUFJSCxHQUNaQSxFQUFNakQsU0FBUSxTQUFVcUQsR0FDdEIsTUFBTUMsRUFBY0MsRUFBZUYsR0FDbkNHLEVBQVVDLE9BQU9ILEVBQ25CLElBQ0FJLEVBQVNDLElBQU1ULEVBQVNOLE9BQ3hCZ0IsRUFBZTlFLFlBQWNvRSxFQUFTZixLQUN0QzBCLEVBQXFCL0UsWUFBY29FLEVBQVNSLFNBRTdDb0IsTUFBTVgsUUFBUVksT0FFakIsTUFBTUMsRUFBaUJDLFNBQVNwRixjQUFjLHNCQUN4Q3FGLEVBQW1CRCxTQUFTcEYsY0FBYyx1QkFDMUNzRixFQUFpQkYsU0FBU3BGLGNBQWMsd0JBQ3hDdUYsRUFBc0JGLEVBQWlCckYsY0FBYyxxQkFDckR3RixFQUFrQkgsRUFBaUJyRixjQUFjLGdCQUNqRHlGLEVBQXVCSixFQUFpQnJGLGNBQzVDLHVCQUVJMEYsRUFBOEJMLEVBQWlCckYsY0FDbkQsOEJBR0kyRixFQUFhUCxTQUFTcEYsY0FBYyxxQkFDcEM0RixFQUFlUixTQUFTcEYsY0FBYyxtQkFDdEM2RixFQUFrQkQsRUFBYTVGLGNBQWMscUJBQzdDOEYsRUFBbUJGLEVBQWE1RixjQUFjLHNCQUM5QytGLEVBQWNILEVBQWE1RixjQUFjLGdCQUN6Q2dHLEVBQW9CSixFQUFhNUYsY0FBYyxzQkFDL0NpRyxFQUFzQkwsRUFBYTVGLGNBQWMsd0JBQ2pEK0UsRUFBaUJLLFNBQVNwRixjQUFjLG1CQUN4Q2dGLEVBQXVCSSxTQUFTcEYsY0FBYyx5QkFFOUNrRyxFQUFjZCxTQUFTcEYsY0FBYyxpQkFDckNtRyxFQUFpQkQsRUFBWWxHLGNBQWMscUJBQzNDb0csRUFBa0JGLEVBQVlsRyxjQUFjLHNCQUM1Q3FHLEVBQWFILEVBQVlsRyxjQUFjLGdCQUN2Q3NHLEVBQWNKLEVBQVlsRyxjQUFjLHlCQUN4QzZFLEVBQVdPLFNBQVNwRixjQUFjLG9CQUVsQ3VHLEVBQWNuQixTQUFTcEYsY0FBYyxpQkFDckN3RyxFQUFhRCxFQUFZdkcsY0FBYyxnQkFFdkN5RyxFQUFZckIsU0FBU3BGLGNBQWMsNkJBQ25DMEcsRUFBc0JILEVBQVl2RyxjQUN0Qyx5Q0FHSTJHLEVBQWV2QixTQUFTcEYsY0FBYyxrQkFDdEM0RyxFQUF1QkQsRUFBYTNHLGNBQWMscUJBQ2xENkcsRUFBaUJGLEVBQWEzRyxjQUFjLGlCQUM1QzhHLEVBQW1CSCxFQUFhM0csY0FBYyxtQkFFcEQsSUFBSStHLEVBQWNDLEVBRWxCLE1BQU1DLEVBQWU3QixTQUNsQnBGLGNBQWMsa0JBQ2RrSCxRQUFRbEgsY0FBYyxTQUNuQjJFLEVBQVlTLFNBQVNwRixjQUFjLGdCQUV6QyxTQUFTMEUsRUFBZXlDLEdBQ3RCLE1BQU0xQyxFQUFjd0MsRUFBYUcsV0FBVSxHQUNyQ0MsRUFBYzVDLEVBQVl6RSxjQUFjLGdCQUN4Q3NILEVBQWM3QyxFQUFZekUsY0FBYyxnQkFDeEN1SCxFQUFnQjlDLEVBQVl6RSxjQUFjLG1CQUNoRCxJQUFJa0UsRUFBVWlELEVBQUtqRCxRQXdDbkIsT0F0Q0lBLEdBQ0ZxRCxFQUFjckgsVUFBVWEsSUFBSSx5QkFHOUJ1RyxFQUFZeEMsSUFBTXFDLEVBQUs1RCxLQUN2QitELEVBQVlFLElBQU1MLEVBQUs3RCxLQUN2QitELEVBQVlwSCxZQUFja0gsRUFBSzdELEtBTS9CaUUsRUFBY0UsaUJBQWlCLFNBQVMsS0FDdEN4RixFQUNHZ0MsaUJBQWlCa0QsRUFBS08sSUFBS3hELEdBQzNCZCxNQUFNdUUsSUFDTHpELEdBQVdBLEVBQ1BBLEVBQ0ZxRCxFQUFjckgsVUFBVWEsSUFBSSx5QkFFNUJ3RyxFQUFjckgsVUFBVUMsT0FBTyw0QkFHbEM4RSxNQUFNWCxRQUFRWSxVQUdLVCxFQUFZekUsY0FBYyxxQkFDbEN5SCxpQkFBaUIsU0FBVUcsR0ErSDdDLFNBQTBCbkQsRUFBYW9ELEdBQ3JDZCxFQUFldEMsRUFDZnVDLEVBQWlCYSxFQUNqQkMsRUFBVXZCLEVBQ1osQ0FsSUl3QixDQUFpQnRELEVBQWEwQyxFQUFLTyxPQUdyQ0osRUFBWUcsaUJBQWlCLFNBQVMsS0FDcENaLEVBQWUvQixJQUFNcUMsRUFBSzVELEtBQzFCc0QsRUFBZVcsSUFBTUwsRUFBSzdELEtBQzFCd0QsRUFBaUI3RyxZQUFja0gsRUFBSzdELEtBQ3BDd0UsRUFBVW5CLE1BR0xsQyxDQUNULENBRUEsU0FBU3FELEVBQVVFLEdBQ2pCQSxFQUFNOUgsVUFBVWEsSUFBSSxtQkFDcEJxRSxTQUFTcUMsaUJBQWlCLFVBQVdRLEVBQ3ZDLENBRUEsU0FBU0MsRUFBV0YsR0FDbEJBLEVBQU05SCxVQUFVQyxPQUFPLG1CQUN2QmlGLFNBQVMrQyxvQkFBb0IsVUFBV0YsRUFDMUMsQ0FFQTlDLEVBQWVzQyxpQkFBaUIsU0FBUyxXQUN2Q2hDLEVBQXFCMkMsTUFBUXJELEVBQWU5RSxZQUM1Q3lGLEVBQTRCMEMsTUFBUXBELEVBQXFCL0UsWUFDekRpQixFQUNFc0UsRUFDQSxDQUFDQyxFQUFzQkMsR0FDdkI3RixHQUVGaUksRUFBVXpDLEVBQ1osSUFFQUUsRUFBb0JrQyxpQkFBaUIsU0FBUyxXQUM1Q1MsRUFBVzdDLEVBQ2IsSUFFQU0sRUFBVzhCLGlCQUFpQixTQUFTLFdBQ25DSyxFQUFVbEMsRUFDWixJQUVBQyxFQUFnQjRCLGlCQUFpQixTQUFTLFdBQ3hDUyxFQUFXdEMsRUFDYixJQUVBZ0IsRUFBcUJhLGlCQUFpQixTQUFTLFdBQzdDUyxFQUFXdkIsRUFDYixJQW9GQW5CLEVBQWdCaUMsaUJBQWlCLFVBbEZqQyxTQUFpQ0csR0FDL0JBLEVBQUlTLGlCQUNKLE1BQU1DLEVBQU1WLEVBQUlXLFVBQ2hCOUcsRUFBYzZHLEdBQUssR0FDbkJyRyxFQUNHMkIsYUFBYSxDQUNaTixLQUFNbUMsRUFBcUIyQyxNQUMzQnZFLE1BQU82QixFQUE0QjBDLFFBRXBDaEYsTUFBTStELElBQ0xwQyxFQUFlOUUsWUFBY2tILEVBQUs3RCxLQUNsQzBCLEVBQXFCL0UsWUFBY2tILEVBQUt0RCxNQUN4Q3FFLEVBQVc3QyxNQUVaSixNQUFNWCxRQUFRWSxPQUNkc0QsU0FBUSxLQUNQL0csRUFBYzZHLEdBQUssS0FFekIsSUFpRUF2QyxFQUFZMEIsaUJBQWlCLFVBN0Q3QixTQUE2QkcsR0FDM0JBLEVBQUlTLGlCQUNKLE1BQU1DLEVBQU1WLEVBQUlXLFVBQ2hCOUcsRUFBYzZHLEdBQUssR0FDbkJyRyxFQUNHb0IsVUFBVTRDLEVBQW9CbUMsTUFBT3BDLEVBQWtCb0MsT0FDdkRoRixNQUFNK0QsSUFDTCxNQUFNMUMsRUFBY0MsRUFBZXlDLEdBQ25DeEMsRUFBVThELFFBQVFoRSxHQUNsQnNCLEVBQVkyQyxRQUNaN0gsRUFBcUJpRixFQUFrQmpHLEdBQ3ZDcUksRUFBV3RDLE1BRVpYLE1BQU1YLFFBQVFZLE9BQ2RzRCxTQUFRLEtBQ1AvRyxFQUFjNkcsR0FBSyxLQUV6QixJQThDQSxNQUFNSyxFQUFZdkQsU0FBU3dELGlCQUFpQixVQUU1QyxTQUFTWCxFQUFnQlksR0FDTCxXQUFkQSxFQUFNQyxLQUVSWixFQURvQjlDLFNBQVNwRixjQUFjLG9CQUcvQyxDQUVBc0YsRUFBZW1DLGlCQUFpQixTQUFTLEtBQ3ZDdkcsRUFBZ0JtRixFQUFZLENBQUNDLEdBQWN6RyxHQUMzQ2lJLEVBQVU1QixNQUdaQyxFQUFlc0IsaUJBQWlCLFNBQVMsS0FDdkNTLEVBQVdoQyxNQUdiRyxFQUFXb0IsaUJBQWlCLFVBQVdHLEtBOUR2QyxTQUE0Qi9DLEVBQVUrQyxHQUNwQ0EsRUFBSVMsaUJBQ0osTUFBTUMsRUFBTVYsRUFBSVcsVUFDaEI5RyxFQUFjNkcsR0FBSyxHQUNuQnJHLEVBQ0c2QixlQUFld0MsRUFBWThCLE9BQzNCaEYsTUFBTStELElBQ0w3QyxRQUFRQyxJQUFJNEMsR0FDWnRDLEVBQVNDLElBQU1xQyxFQUFLcEQsT0FDcEJzQyxFQUFXcUMsUUFDWDdILEVBQXFCdUYsRUFBaUJ2RyxHQUN0Q3FJLEVBQVdoQyxNQUVaakIsTUFBTVgsUUFBUVksT0FDZHNELFNBQVEsS0FDUC9HLEVBQWM2RyxHQUFLLEtBRXpCLENBOENFUyxDQUFtQmxFLEVBQVUrQyxNQUcvQnBCLEVBQVdpQixpQkFBaUIsVUEvQzVCLFNBQTRCRyxHQUMxQkEsRUFBSVMsaUJBQ0osTUFBTUMsRUFBTVYsRUFBSVcsVUFDaEI5RyxFQUFjNkcsR0FBSyxFQUFNLFVBQ3pCckcsRUFDRytCLFdBQVdnRCxHQUNYNUQsTUFBSyxLQUNKMkQsRUFBYTVHLFNBQ2IrSCxFQUFXM0IsTUFFWnRCLE1BQU1YLFFBQVFZLE9BQ2RzRCxTQUFRLEtBQ1AvRyxFQUFjNkcsR0FBSyxFQUFPLFlBRWhDLElBbUNBN0IsRUFBVWdCLGlCQUFpQixTQUFTLEtBQ2xDUyxFQUFXM0IsTUFHYkcsRUFBb0JlLGlCQUFpQixTQUFTLEtBQzVDUyxFQUFXM0IsTUFHYm9DLEVBQVV4SCxTQUFTNkcsSUFDakJBLEVBQU1QLGlCQUFpQixhQUFjRyxJQUMvQkEsRUFBSW9CLE9BQU85SSxVQUFVK0ksU0FBUyxVQUNoQ2YsRUFBV0YsU0g1UGdCbkksS0FDZHVGLFNBQVN3RCxpQkFBaUIvSSxFQUFTd0IsY0FDM0NGLFNBQVN4QixJQWhCTXVKLEVBQUN2SixFQUFRRSxLQUNqQyxNQUFNUyxFQUFZNkksTUFBTUMsS0FBS3pKLEVBQU9pSixpQkFBaUIvSSxFQUFTeUIsZ0JBQ3hEK0gsRUFBZ0IxSixFQUFPSyxjQUFjSCxFQUFTMEIsc0JBRXBEbEIsRUFBa0JDLEVBQVcrSSxFQUFleEosR0FFNUNTLEVBQVVhLFNBQVNWLElBQ2pCQSxFQUFhZ0gsaUJBQWlCLFNBQVMsV0E3Q2hCNkIsRUFBQzNKLEVBQVFDLEVBQVNDLEtBQ3RDRCxFQUFRYyxTQUFTQyxNQUdwQmpCLEVBQWVDLEVBQVFDLEVBQVNDLEdBbEJiMEosRUFBQzVKLEVBQVFDLEVBQVM0SixFQUFjM0osS0FDckQsTUFBTUMsRUFBaUJGLEVBQVFHLEdBQUssU0FDYkosRUFBT0ssY0FBYyxJQUFNRixHQUNuQ0csWUFBY3VKLEVBQzdCNUosRUFBUU0sVUFBVWEsSUFBSWxCLEVBQVNPLGtCQVk3Qm1KLENBQWU1SixFQUFRQyxFQUFTQSxFQUFRNkosa0JBQW1CNUosSUE0Q3pEeUosQ0FBbUIzSixFQUFRYyxFQUFjWixHQUN6Q1EsRUFBa0JDLEVBQVcrSSxFQUFleEosRUFDOUMsUUFPQXFKLENBQWtCdkosRUFBUUUsT0c4UDlCNkosQ0FBaUI3SixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vU0VfUFJPSkVDVF9TUE9UUy8uL3NyYy9wYWdlcy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL1NFX1BST0pFQ1RfU1BPVFMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL1NFX1BST0pFQ1RfU1BPVFMvLi9zcmMvdXRpbHMvaGVscGVycy5qcyIsIndlYnBhY2s6Ly9TRV9QUk9KRUNUX1NQT1RTLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL1NFX1BST0pFQ1RfU1BPVFMvLi9zcmMvdXRpbHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgZXJyb3JNZXNzYWdlLCBzZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTWVzc2FnZUlEID0gaW5wdXRFbC5pZCArIFwiLWVycm9yXCI7XHJcbiAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTWVzc2FnZUlEKTtcclxuICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgc2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBlcnJvck1lc3NhZ2VJRCA9IGlucHV0RWwuaWQgKyBcIi1lcnJvclwiO1xyXG4gIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoXCIjXCIgKyBlcnJvck1lc3NhZ2VJRCk7XHJcbiAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbCwgaW5wdXRFbCwgc2V0dGluZ3MpID0+IHtcclxuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgc2V0dGluZ3MpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIHNldHRpbmdzKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XHJcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCwgc2V0dGluZ3MpID0+IHtcclxuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgIGRpc2FibGVkU3VibWl0QnV0dG9uKGJ1dHRvbkVsLCBzZXR0aW5ncyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGVuYWJsZUJ1dHRvbihidXR0b25FbCwgc2V0dGluZ3MpO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBkaXNhYmxlZFN1Ym1pdEJ1dHRvbiA9IChidXR0b25FbCwgc2V0dGluZ3MpID0+IHtcclxuICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxufTtcclxuXHJcbmNvbnN0IGVuYWJsZUJ1dHRvbiA9IChidXR0b25FbCwgc2V0dGluZ3MpID0+IHtcclxuICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gZmFsc2U7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbCwgaW5wdXRMaXN0LCBzZXR0aW5ncykgPT4ge1xyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dCwgc2V0dGluZ3MpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBzZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbGVtZW50LCBzZXR0aW5ncyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChzZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5mb3JtU2VsZWN0b3IpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBzZXR0aW5ncyk7XHJcbiAgfSk7XHJcbn07XHJcbiIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07IiwiZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckxvYWRpbmcoXHJcbiAgYnV0dG9uLFxyXG4gIGlzTG9hZGluZyxcclxuICBidXR0b25UZXh0ID0gYnV0dG9uLnRleHRDb250ZW50LFxyXG4gIGxvYWRpbmdUZXh0ID0gYCR7YnV0dG9uVGV4dC5zbGljZSgwLCAtMSl9aW5nLi4uYFxyXG4pIHtcclxuICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICBidXR0b24uZGF0YXNldC5vcmlnaW5hbFRleHQgPSBidXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uLmRhdGFzZXQub3JpZ2luYWxUZXh0IHx8IGJ1dHRvblRleHQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7XHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxuICByZXNldFZhbGlkYXRpb24sXHJcbiAgZGlzYWJsZWRTdWJtaXRCdXR0b24sXHJcbn0gZnJvbSBcIi4vdmFsaWRhdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IHsgcmVuZGVyTG9hZGluZyB9IGZyb20gXCIuLi91dGlscy9oZWxwZXJzLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xyXG5cclxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiR29sZGVuIEdhdGUgYnJpZGdlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIwY2JjZDAyMS05ZTFhLTQ5MTAtOGU5YS0yNmY5YjY1NDkwYjNcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuYXBpXHJcbiAgLmdldEFwcEluZm8oKVxyXG4gIC50aGVuKChbY2FyZHMsIHVzZXJJbmZvXSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coY2FyZHMpO1xyXG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xyXG4gICAgICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gICAgYXZhdGFyRWwuc3JjID0gdXNlckluZm8uYXZhdGFyO1xyXG4gICAgcHJvZmlsZVRpdGxlRWwudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuICB9KVxyXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVDbG9zZUJ0biA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlTmFtZUlucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiXHJcbik7XHJcbmNvbnN0IGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbmNvbnN0IG5ld1Bvc3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XHJcbmNvbnN0IG5ld1Bvc3RDbG9zZUJ0biA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IG5ld1Bvc3RTdWJtaXRCdG4gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcclxuY29uc3QgbmV3UG9zdEZvcm0gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgbmV3UG9zdEltYWdlSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiAjY2FyZC1pbWFnZS1pbnB1dFwiKTtcclxuY29uc3QgbmV3UG9zdENhcHRpb25JbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiICNjYXJkLWNhcHRpb24taW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5cclxuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcclxuY29uc3QgYXZhdGFyQ2xvc2VCdG4gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IGF2YXRhclN1Ym1pdEJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBhdmF0YXJJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItaW5wdXRcIik7XHJcbmNvbnN0IGF2YXRhckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XHJcblxyXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVmb3JtID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcbmNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5fY2FuY2VsXCIpO1xyXG5jb25zdCBkZWxldGVNb2RhbENsb3NlQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fY2xvc2UtYnRuX2NvbmZpcm1hdGlvbl9kZWxldGVcIlxyXG4pO1xyXG5cclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IHByZXZpZXdJbWFnZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG5jb25zdCBwcmV2aWV3Q2FwdGlvbkVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcblxyXG5sZXQgc2VsZWN0ZWRDYXJkLCBzZWxlY3RlZENhcmRJZDtcclxuXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKVxyXG4gIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKTtcclxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY29uc3QgY2FyZFRpdGxlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjb25zdCBjYXJkTGlrZUJ0bkVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcclxuICBsZXQgaXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuXHJcbiAgaWYgKGlzTGlrZWQpIHtcclxuICAgIGNhcmRMaWtlQnRuRWwuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIGNhcmRJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcclxuICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcblxyXG4gIC8vIHNldCB1cCBldmVudCBsaXN0ZW5lciBvbiB0aGUgbGlrZUJ1dHRvbiwgc28gdGhhdCB3aGVuIHdlIGNsaWNrIGl0LCBpdCBkb2VzOlxyXG4gIC8vIGlmIHRoZSBjYXJkIGlzIG5vdCBsaWtlZCwgd2UgbGlrZSBpdCwgb3RoZXJ3aXNlIHdlIHVubGlrZSBpdC5cclxuICAvLyB0byBsaWtlIGEgY2FyZCB3ZSAxc3QgbWFrZSBhIGZldGNoIHJlcXVlc3QgdG8gbGlrZSB0aGUgY2FyZCBvbiB0aGUgc2VydmVyLiBUaGVuLCBpZlxyXG4gIC8vdGhhdCdzIHN1Y2Nlc3NmdWwsIHdlIGxpa2UgdGhlIGNhcmQgb24gdGhlIERPTSAodmlzdWFsbHkpLCBhbmQgd2UgdXBkYXRlIHRoZSBpc0xpa2VkIHZhcmlhYmxlIHRvIGJlIHRydWVcclxuICBjYXJkTGlrZUJ0bkVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLmhhbmRsZUxpa2VTdGF0dXMoZGF0YS5faWQsIGlzTGlrZWQpXHJcbiAgICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xyXG4gICAgICAgIGlzTGlrZWQgPSAhaXNMaWtlZDtcclxuICAgICAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICAgICAgY2FyZExpa2VCdG5FbC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idG5fYWN0aXZlXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjYXJkTGlrZUJ0bkVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGNhcmREZWxldGVCdG5FbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcclxuICBjYXJkRGVsZXRlQnRuRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XHJcbiAgICBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhLl9pZClcclxuICApO1xyXG5cclxuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgcHJldmlld0ltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgcHJldmlld0ltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgcHJldmlld0NhcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlS2V5KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlS2V5KTtcclxufVxyXG5cclxuZWRpdFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVUaXRsZUVsLnRleHRDb250ZW50O1xyXG4gIGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbkVsLnRleHRDb250ZW50O1xyXG4gIHJlc2V0VmFsaWRhdGlvbihcclxuICAgIGVkaXRQcm9maWxlRm9ybSxcclxuICAgIFtlZGl0UHJvZmlsZU5hbWVJbnB1dCwgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0XSxcclxuICAgIHNldHRpbmdzXHJcbiAgKTtcclxuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuZWRpdFByb2ZpbGVDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pO1xyXG5cclxubmV3UG9zdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIG9wZW5Nb2RhbChuZXdQb3N0TW9kYWwpO1xyXG59KTtcclxuXHJcbm5ld1Bvc3RDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufSk7XHJcblxyXG5wcmV2aWV3TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBidG4gPSBldnQuc3VibWl0dGVyO1xyXG4gIHJlbmRlckxvYWRpbmcoYnRuLCB0cnVlKTtcclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSxcclxuICAgICAgYWJvdXQ6IGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSxcclxuICAgIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBwcm9maWxlVGl0bGVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICByZW5kZXJMb2FkaW5nKGJ0biwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vaW1wbGVtZW50IGxvYWRpbmcgdGV4dCBmb3Igb3RoZXIgZm9yIHN1Ym1pc3Npb24gXCJkZWxldGluZy4uXCJcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU5ld1Bvc3RTdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgYnRuID0gZXZ0LnN1Ym1pdHRlcjtcclxuICByZW5kZXJMb2FkaW5nKGJ0biwgdHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuUG9zdENhcmRzKG5ld1Bvc3RDYXB0aW9uSW5wdXQudmFsdWUsIG5ld1Bvc3RJbWFnZUlucHV0LnZhbHVlKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICBuZXdQb3N0Rm9ybS5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlZFN1Ym1pdEJ1dHRvbihuZXdQb3N0U3VibWl0QnRuLCBzZXR0aW5ncyk7XHJcbiAgICAgIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhidG4sIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoYXZhdGFyRWwsIGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IGJ0biA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgcmVuZGVyTG9hZGluZyhidG4sIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRBdmF0YXJJbmZvKGF2YXRhcklucHV0LnZhbHVlKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgIGF2YXRhckVsLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgICBhdmF0YXJGb3JtLnJlc2V0KCk7XHJcbiAgICAgIGRpc2FibGVkU3VibWl0QnV0dG9uKGF2YXRhclN1Ym1pdEJ0biwgc2V0dGluZ3MpO1xyXG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhidG4sIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgYnRuID0gZXZ0LnN1Ym1pdHRlcjtcclxuICByZW5kZXJMb2FkaW5nKGJ0biwgdHJ1ZSwgXCJEZWxldGVcIik7XHJcbiAgYXBpXHJcbiAgICAuZGVsZXRlQ2FyZChzZWxlY3RlZENhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xyXG4gICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhidG4sIGZhbHNlLCBcIkRlbGV0ZVwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkSWQpIHtcclxuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcclxuICBzZWxlY3RlZENhcmRJZCA9IGNhcmRJZDtcclxuICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59XHJcblxyXG5lZGl0UHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0UHJvZmlsZVN1Ym1pdCk7XHJcbm5ld1Bvc3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlTmV3UG9zdFN1Ym1pdCk7XHJcblxyXG5jb25zdCBtb2RhbExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRXNjYXBlS2V5KGV2ZW50KSB7XHJcbiAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY29uc3QgYWN0aXZlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX2lzLW9wZW5lZFwiKTtcclxuICAgIGNsb3NlTW9kYWwoYWN0aXZlTW9kYWwpO1xyXG4gIH1cclxufVxyXG5cclxuYXZhdGFyTW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICByZXNldFZhbGlkYXRpb24oYXZhdGFyRm9ybSwgW2F2YXRhcklucHV0XSwgc2V0dGluZ3MpO1xyXG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XHJcbn0pO1xyXG5cclxuYXZhdGFyQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gIGhhbmRsZUF2YXRhclN1Ym1pdChhdmF0YXJFbCwgZXZ0KTtcclxufSk7XHJcblxyXG5kZWxldGVmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcclxuXHJcbmNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59KTtcclxuXHJcbmRlbGV0ZU1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufSk7XHJcblxyXG5tb2RhbExpc3QuZm9yRWFjaCgobW9kYWwpID0+IHtcclxuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLmNoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLmNoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgUG9zdENhcmRzKG5hbWUsIGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0QXZhdGFySW5mbyhhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLmNoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwic2V0dGluZ3MiLCJlcnJvck1lc3NhZ2VJRCIsImlkIiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiaW5wdXRFcnJvckNsYXNzIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbCIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWRTdWJtaXRCdXR0b24iLCJlbmFibGVCdXR0b24iLCJhZGQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwiaW5wdXQiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJlcnJvckNsYXNzIiwicmVuZGVyTG9hZGluZyIsImJ1dHRvbiIsImlzTG9hZGluZyIsImJ1dHRvblRleHQiLCJsb2FkaW5nVGV4dCIsInNsaWNlIiwiZGF0YXNldCIsIm9yaWdpbmFsVGV4dCIsImFwaSIsImNvbnN0cnVjdG9yIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImNoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0QXBwSW5mbyIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwiUG9zdENhcmRzIiwibmFtZSIsImxpbmsiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRVc2VySW5mbyIsImFib3V0IiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJkZWxldGVDYXJkIiwiaGFuZGxlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwiY2FyZHMiLCJ1c2VySW5mbyIsImNvbnNvbGUiLCJsb2ciLCJpdGVtIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImNhcmRzTGlzdCIsImFwcGVuZCIsImF2YXRhckVsIiwic3JjIiwicHJvZmlsZVRpdGxlRWwiLCJwcm9maWxlRGVzY3JpcHRpb25FbCIsImNhdGNoIiwiZXJyb3IiLCJlZGl0UHJvZmlsZUJ0biIsImRvY3VtZW50IiwiZWRpdFByb2ZpbGVNb2RhbCIsImF2YXRhck1vZGFsQnRuIiwiZWRpdFByb2ZpbGVDbG9zZUJ0biIsImVkaXRQcm9maWxlRm9ybSIsImVkaXRQcm9maWxlTmFtZUlucHV0IiwiZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwibmV3UG9zdEJ0biIsIm5ld1Bvc3RNb2RhbCIsIm5ld1Bvc3RDbG9zZUJ0biIsIm5ld1Bvc3RTdWJtaXRCdG4iLCJuZXdQb3N0Rm9ybSIsIm5ld1Bvc3RJbWFnZUlucHV0IiwibmV3UG9zdENhcHRpb25JbnB1dCIsImF2YXRhck1vZGFsIiwiYXZhdGFyQ2xvc2VCdG4iLCJhdmF0YXJTdWJtaXRCdG4iLCJhdmF0YXJGb3JtIiwiYXZhdGFySW5wdXQiLCJkZWxldGVNb2RhbCIsImRlbGV0ZWZvcm0iLCJjYW5jZWxCdG4iLCJkZWxldGVNb2RhbENsb3NlQnRuIiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsQ2xvc2VCdG4iLCJwcmV2aWV3SW1hZ2VFbCIsInByZXZpZXdDYXB0aW9uRWwiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImNhcmRUZW1wbGF0ZSIsImNvbnRlbnQiLCJkYXRhIiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlRWwiLCJjYXJkSW1hZ2VFbCIsImNhcmRMaWtlQnRuRWwiLCJhbHQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2lkIiwidXBkYXRlZENhcmQiLCJldnQiLCJjYXJkSWQiLCJvcGVuTW9kYWwiLCJoYW5kbGVEZWxldGVDYXJkIiwibW9kYWwiLCJoYW5kbGVFc2NhcGVLZXkiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJidG4iLCJzdWJtaXR0ZXIiLCJmaW5hbGx5IiwicHJlcGVuZCIsInJlc2V0IiwibW9kYWxMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsImV2ZW50Iiwia2V5IiwiaGFuZGxlQXZhdGFyU3VibWl0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImJ1dHRvbkVsZW1lbnQiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=